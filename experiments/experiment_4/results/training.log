=== Starting new training run ===
Parameters:
  Hidden size: 100
  Epochs: 50
  Batch size: 32
  Learning rate: 0.0005
  Device: cpu
Loading pre-processed data...
Sequence length: 60
Feature count: 5
Close price index: 3
Training set shape: torch.Size([4224, 60, 5])
Validation set shape: torch.Size([858, 60, 5])
Test set shape: torch.Size([858, 60, 5])
Model input size: 5
Starting training process...
Starting training process
Model architecture:
PricePredictionModel(
  (lstm): CustomLSTM()
  (linear): Linear(in_features=100, out_features=1, bias=True)
)
Training parameters: epochs=50, device=cpu
Optimizer: SSAOptimizer(pop_size=30, a=0.5, ST=0.8)
Loss function: MSELoss()
Training batches: 132
Validation batches: 27

Starting Epoch [1/50]

First batch details:
Scaled predictions (first 3):
[[-0.0345881 ]
 [-0.04914233]
 [-0.04534553]]
Scaled targets (first 3):
[0.33975944 0.16655481 0.22482578]
Price predictions (first 3):
[14538.70797489 14068.14478008 14190.90193048]
Price targets (first 3):
[26642.00026135 21042.00010575 22925.99981879]
Initial normalized MSE: 0.186823
Initial price-scale MSE: 195293590.05
Epoch [1/50] Summary:
  Normalized - Train MSE: 0.228468, RMSE: 0.477983
  Normalized - Val MSE: 1.674023, RMSE: 1.293840
  Price Scale - Train MSE: 238826529.80, RMSE: $15454.01
  Price Scale - Val MSE: 1749921010.26, RMSE: $41832.06

Starting Epoch [2/50]
Epoch [2/50] Summary:
  Normalized - Train MSE: 0.228468, RMSE: 0.477983
  Normalized - Val MSE: 1.674023, RMSE: 1.293840
  Price Scale - Train MSE: 238826529.80, RMSE: $15454.01
  Price Scale - Val MSE: 1749921010.26, RMSE: $41832.06

Starting Epoch [3/50]
Epoch [3/50] Summary:
  Normalized - Train MSE: 0.226884, RMSE: 0.476324
  Normalized - Val MSE: 0.139084, RMSE: 0.372939
  Price Scale - Train MSE: 237170865.52, RMSE: $15400.35
  Price Scale - Val MSE: 145389762.39, RMSE: $12057.77

Starting Epoch [4/50]
Epoch [4/50] Summary:
  Normalized - Train MSE: 0.200019, RMSE: 0.447234
  Normalized - Val MSE: 0.139084, RMSE: 0.372939
  Price Scale - Train MSE: 209087215.98, RMSE: $14459.85
  Price Scale - Val MSE: 145389762.39, RMSE: $12057.77

Starting Epoch [5/50]
Epoch [5/50] Summary:
  Normalized - Train MSE: 0.200019, RMSE: 0.447234
  Normalized - Val MSE: 0.139084, RMSE: 0.372939
  Price Scale - Train MSE: 209087215.98, RMSE: $14459.85
  Price Scale - Val MSE: 145389762.39, RMSE: $12057.77

Starting Epoch [6/50]
Epoch [6/50] Summary:
  Normalized - Train MSE: 0.033591, RMSE: 0.183279
  Normalized - Val MSE: 0.702338, RMSE: 0.838056
  Price Scale - Train MSE: 35114055.83, RMSE: $5925.71
  Price Scale - Val MSE: 734180767.83, RMSE: $27095.77

Starting Epoch [7/50]
Epoch [7/50] Summary:
  Normalized - Train MSE: 0.019487, RMSE: 0.139597
  Normalized - Val MSE: 0.600695, RMSE: 0.775045
  Price Scale - Train MSE: 20370718.81, RMSE: $4513.39
  Price Scale - Val MSE: 627929374.04, RMSE: $25058.52

Starting Epoch [8/50]
Epoch [8/50] Summary:
  Normalized - Train MSE: 0.013842, RMSE: 0.117653
  Normalized - Val MSE: 0.600695, RMSE: 0.775045
  Price Scale - Train MSE: 14469810.26, RMSE: $3803.92
  Price Scale - Val MSE: 627929374.04, RMSE: $25058.52

Starting Epoch [9/50]
Epoch [9/50] Summary:
  Normalized - Train MSE: 0.013842, RMSE: 0.117653
  Normalized - Val MSE: 0.600695, RMSE: 0.775045
  Price Scale - Train MSE: 14469810.26, RMSE: $3803.92
  Price Scale - Val MSE: 627929374.04, RMSE: $25058.52

Starting Epoch [10/50]
Epoch [10/50] Summary:
  Normalized - Train MSE: 0.012122, RMSE: 0.110099
  Normalized - Val MSE: 0.129872, RMSE: 0.360378
  Price Scale - Train MSE: 12671269.11, RMSE: $3559.67
  Price Scale - Val MSE: 135760221.95, RMSE: $11651.62

Starting Epoch [11/50]
Epoch [11/50] Summary:
  Normalized - Train MSE: 0.009806, RMSE: 0.099026
  Normalized - Val MSE: 0.129872, RMSE: 0.360378
  Price Scale - Train MSE: 10250648.40, RMSE: $3201.66
  Price Scale - Val MSE: 135760221.95, RMSE: $11651.62

Starting Epoch [12/50]
Epoch [12/50] Summary:
  Normalized - Train MSE: 0.017209, RMSE: 0.131185
  Normalized - Val MSE: 0.631011, RMSE: 0.794362
  Price Scale - Train MSE: 17989650.59, RMSE: $4241.42
  Price Scale - Val MSE: 659620238.88, RMSE: $25683.07

Starting Epoch [13/50]
Epoch [13/50] Summary:
  Normalized - Train MSE: 0.017946, RMSE: 0.133962
  Normalized - Val MSE: 0.631011, RMSE: 0.794362
  Price Scale - Train MSE: 18759320.49, RMSE: $4331.20
  Price Scale - Val MSE: 659620238.88, RMSE: $25683.07

Starting Epoch [14/50]
Epoch [14/50] Summary:
  Normalized - Train MSE: 0.009727, RMSE: 0.098625
  Normalized - Val MSE: 0.398765, RMSE: 0.631478
  Price Scale - Train MSE: 10167815.44, RMSE: $3188.70
  Price Scale - Val MSE: 416844463.02, RMSE: $20416.77

Starting Epoch [15/50]
Epoch [15/50] Summary:
  Normalized - Train MSE: 0.010657, RMSE: 0.103232
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 11140034.42, RMSE: $3337.67
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [16/50]
Epoch [16/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [17/50]
Epoch [17/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [18/50]
Epoch [18/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [19/50]
Epoch [19/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [20/50]
Epoch [20/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [21/50]
Epoch [21/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [22/50]
Epoch [22/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [23/50]
Epoch [23/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [24/50]
Epoch [24/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [25/50]
Epoch [25/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [26/50]
Epoch [26/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [27/50]
Epoch [27/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [28/50]
Epoch [28/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [29/50]
Epoch [29/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [30/50]
Epoch [30/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [31/50]
Epoch [31/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [32/50]
Epoch [32/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [33/50]
Epoch [33/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [34/50]
Epoch [34/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [35/50]
Epoch [35/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [36/50]
Epoch [36/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [37/50]
Epoch [37/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [38/50]
Epoch [38/50] Summary:
  Normalized - Train MSE: 0.023428, RMSE: 0.153062
  Normalized - Val MSE: 0.401277, RMSE: 0.633464
  Price Scale - Train MSE: 24490061.32, RMSE: $4948.74
  Price Scale - Val MSE: 419470226.69, RMSE: $20480.97

Starting Epoch [39/50]
Epoch [39/50] Summary:
  Normalized - Train MSE: 0.016397, RMSE: 0.128049
  Normalized - Val MSE: 1.087169, RMSE: 1.042674
  Price Scale - Train MSE: 17139910.43, RMSE: $4140.04
  Price Scale - Val MSE: 1136459905.18, RMSE: $33711.42

Starting Epoch [40/50]
Epoch [40/50] Summary:
  Normalized - Train MSE: 0.005656, RMSE: 0.075204
  Normalized - Val MSE: 1.087169, RMSE: 1.042674
  Price Scale - Train MSE: 5912066.73, RMSE: $2431.47
  Price Scale - Val MSE: 1136459905.18, RMSE: $33711.42

Starting Epoch [41/50]
Epoch [41/50] Summary:
  Normalized - Train MSE: 0.005656, RMSE: 0.075204
  Normalized - Val MSE: 1.087169, RMSE: 1.042674
  Price Scale - Train MSE: 5912066.73, RMSE: $2431.47
  Price Scale - Val MSE: 1136459905.18, RMSE: $33711.42

Starting Epoch [42/50]
Epoch [42/50] Summary:
  Normalized - Train MSE: 0.005533, RMSE: 0.074384
  Normalized - Val MSE: 0.223019, RMSE: 0.472249
  Price Scale - Train MSE: 5783809.00, RMSE: $2404.96
  Price Scale - Val MSE: 233130387.70, RMSE: $15268.61

Starting Epoch [43/50]
Epoch [43/50] Summary:
  Normalized - Train MSE: 0.004846, RMSE: 0.069617
  Normalized - Val MSE: 0.223019, RMSE: 0.472249
  Price Scale - Train MSE: 5066202.20, RMSE: $2250.82
  Price Scale - Val MSE: 233130387.70, RMSE: $15268.61

Starting Epoch [44/50]
Epoch [44/50] Summary:
  Normalized - Train MSE: 0.004846, RMSE: 0.069617
  Normalized - Val MSE: 0.223019, RMSE: 0.472249
  Price Scale - Train MSE: 5066202.20, RMSE: $2250.82
  Price Scale - Val MSE: 233130387.70, RMSE: $15268.61

Starting Epoch [45/50]
Epoch [45/50] Summary:
  Normalized - Train MSE: 0.006066, RMSE: 0.077883
  Normalized - Val MSE: 0.438392, RMSE: 0.662112
  Price Scale - Train MSE: 6340802.28, RMSE: $2518.09
  Price Scale - Val MSE: 458268405.97, RMSE: $21407.20

Starting Epoch [46/50]
Epoch [46/50] Summary:
  Normalized - Train MSE: 0.006378, RMSE: 0.079862
  Normalized - Val MSE: 0.438392, RMSE: 0.662112
  Price Scale - Train MSE: 6667149.89, RMSE: $2582.08
  Price Scale - Val MSE: 458268405.97, RMSE: $21407.20

Starting Epoch [47/50]
Epoch [47/50] Summary:
  Normalized - Train MSE: 0.006378, RMSE: 0.079862
  Normalized - Val MSE: 0.438392, RMSE: 0.662112
  Price Scale - Train MSE: 6667149.89, RMSE: $2582.08
  Price Scale - Val MSE: 458268405.97, RMSE: $21407.20

Starting Epoch [48/50]
Epoch [48/50] Summary:
  Normalized - Train MSE: 0.006054, RMSE: 0.077805
  Normalized - Val MSE: 0.064827, RMSE: 0.254612
  Price Scale - Train MSE: 6328029.38, RMSE: $2515.56
  Price Scale - Val MSE: 67766672.64, RMSE: $8232.05

Starting Epoch [49/50]
Epoch [49/50] Summary:
  Normalized - Train MSE: 0.003158, RMSE: 0.056194
  Normalized - Val MSE: 0.064827, RMSE: 0.254612
  Price Scale - Train MSE: 3300886.30, RMSE: $1816.83
  Price Scale - Val MSE: 67766672.64, RMSE: $8232.05

Starting Epoch [50/50]
Epoch [50/50] Summary:
  Normalized - Train MSE: 0.003158, RMSE: 0.056194
  Normalized - Val MSE: 0.064827, RMSE: 0.254612
  Price Scale - Train MSE: 3300886.30, RMSE: $1816.83
  Price Scale - Val MSE: 67766672.64, RMSE: $8232.05
Training completed
Training completed in 2379.02 seconds
Saving model and results...
Starting evaluation process...
Generating predictions...
Creating visualizations...
Training history plot saved
Prediction analysis plots saved
Metrics and sample predictions tables saved
Error distribution and time series plots saved
Evaluation metrics (for test set):
  Mean Squared Error: 91700822.39
  Root Mean Squared Error: 9576.05
  Mean Absolute Error: 7997.61
  R² Score: -1.64
