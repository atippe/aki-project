=== Starting new training run ===
Crypto Currency: btc

Model Parameters:
  hidden_size: 1024
  num_layers: 6
  dropout: 0.3
  num_epochs: 50
  batch_size: 64
  learning_rate: 0.0001
  device: cpu
  weight_decay: 1e-05
  betas: (0.9, 0.999)
  eps: 1e-08
  criterion: MSE
Loading pre-processed data...

=== Dataset Configuration ===
Sequence length: 60
Feature count: 5
Feature indices: {'Volume': 0, 'Open': 1, 'High': 2, 'Low': 3, 'Close': 4}
Close price index: 4

=== Data Shapes ===
Training set shape: torch.Size([3312, 60, 5])
Validation set shape: torch.Size([659, 60, 5])
Test set shape: torch.Size([660, 60, 5])

=== Date Range ===
Start date: 2011-08-18
End date: 2024-10-30

=== Feature Alignment Verification ===
Feature alignment test - Close position: 4
Inverse transform test shape: (1, 5)
Prediction steps: 5
Model input size: 5
Starting training process...
Starting training process
Model architecture:
MultiStepPricePredictionModel(
  (lstm): EnhancedLSTM(
    (lstm_cells): ModuleList(
      (0): CustomLSTMCell(
        (dropout): Dropout(p=0.3, inplace=False)
        (layer_norm_1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layer_norm_2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (gates): Linear(in_features=1029, out_features=4096, bias=True)
        (residual_proj): Linear(in_features=5, out_features=1024, bias=True)
      )
      (1-5): 5 x CustomLSTMCell(
        (dropout): Dropout(p=0.3, inplace=False)
        (layer_norm_1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layer_norm_2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (gates): Linear(in_features=2048, out_features=4096, bias=True)
      )
    )
    (attention): AttentionLayer(
      (attention): Sequential(
        (0): Linear(in_features=1024, out_features=1024, bias=True)
        (1): Tanh()
        (2): Linear(in_features=1024, out_features=1, bias=True)
      )
    )
    (skip_connections): ModuleList(
      (0-5): 6 x Linear(in_features=5, out_features=1024, bias=True)
    )
  )
  (prediction_heads): ModuleList(
    (0-4): 5 x Sequential(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (2): ReLU()
      (3): Dropout(p=0.3, inplace=False)
      (4): Linear(in_features=1024, out_features=512, bias=True)
      (5): ReLU()
      (6): Dropout(p=0.3, inplace=False)
      (7): Linear(in_features=512, out_features=1, bias=True)
    )
  )
)
Training parameters: epochs=50, device=cpu
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 1e-05
)
Loss function: MSELoss()
Training batches: 52
Validation batches: 11

Starting Epoch [1/50]

First batch details:
Scaled predictions (first 3):
[[ 0.13175067]
 [ 0.30141222]
 [-0.08924343]]
Scaled targets (first 3):
[ 0.90680444  1.04465    -0.18903045]
Price predictions (first 3):
[ 828.07135284 1244.42209165  486.97513701]
Price targets (first 3):
[5318.99955251 7403.49931175  383.11077197]
Initial normalized MSE: 0.986348
Initial price-scale MSE: 20240994.87
Epoch [1/50] Summary:
  Normalized - Train MSE: 0.061265, RMSE: 0.247518
  Normalized - Val MSE: 0.185349, RMSE: 0.430521
  Price Scale - Train MSE: 9246825.26, RMSE: $3040.86
  Price Scale - Val MSE: 772519201.44, RMSE: $27794.23

Starting Epoch [2/50]
Epoch [2/50] Summary:
  Normalized - Train MSE: 0.020361, RMSE: 0.142691
  Normalized - Val MSE: 0.144287, RMSE: 0.379852
  Price Scale - Train MSE: 3699132.65, RMSE: $1923.31
  Price Scale - Val MSE: 683909119.92, RMSE: $26151.66

Starting Epoch [3/50]
Epoch [3/50] Summary:
  Normalized - Train MSE: 0.015827, RMSE: 0.125804
  Normalized - Val MSE: 0.168239, RMSE: 0.410170
  Price Scale - Train MSE: 3088631.36, RMSE: $1757.45
  Price Scale - Val MSE: 735872620.58, RMSE: $27126.97

Starting Epoch [4/50]
Epoch [4/50] Summary:
  Normalized - Train MSE: 0.013069, RMSE: 0.114320
  Normalized - Val MSE: 0.125282, RMSE: 0.353952
  Price Scale - Train MSE: 2432582.18, RMSE: $1559.67
  Price Scale - Val MSE: 630175622.54, RMSE: $25103.30

Starting Epoch [5/50]
