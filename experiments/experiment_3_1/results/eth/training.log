=== Starting new training run ===
Crypto Currency: eth

Model Parameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.2
  num_epochs: 50
  batch_size: 32
  learning_rate: 0.001
  device: cpu
  weight_decay: 1e-05
  betas: (0.9, 0.999)
  eps: 1e-08
  criterion: MSE
Loading pre-processed data...

=== Dataset Configuration ===
Sequence length: 60
Feature count: 5
Feature indices: {'Volume': 0, 'Open': 1, 'High': 2, 'Low': 3, 'Close': 4}
Close price index: 4

=== Data Shapes ===
Training set shape: torch.Size([12345, 60, 5])
Validation set shape: torch.Size([2598, 60, 5])
Test set shape: torch.Size([2599, 60, 5])

=== Date Range ===
Start date: 2016-09-29
End date: 2024-10-30

=== Feature Alignment Verification ===
Feature alignment test - Close position: 4
Inverse transform test shape: (1, 5)
Model input size: 5
Starting training process...
Starting training process
Model architecture:
AdvancedPricePredictionModel(
  (lstm): EnhancedLSTM(
    (lstm_cells): ModuleList(
      (0): CustomLSTMCell(
        (dropout): Dropout(p=0.2, inplace=False)
        (layer_norm_1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (layer_norm_2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (gates): Linear(in_features=133, out_features=512, bias=True)
        (residual_proj): Linear(in_features=5, out_features=128, bias=True)
      )
      (1): CustomLSTMCell(
        (dropout): Dropout(p=0.2, inplace=False)
        (layer_norm_1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (layer_norm_2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (gates): Linear(in_features=256, out_features=512, bias=True)
      )
    )
    (attention): AttentionLayer(
      (attention): Sequential(
        (0): Linear(in_features=128, out_features=128, bias=True)
        (1): Tanh()
        (2): Linear(in_features=128, out_features=1, bias=True)
      )
    )
    (skip_connections): ModuleList(
      (0-1): 2 x Linear(in_features=5, out_features=128, bias=True)
    )
  )
  (prediction_head): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
Training parameters: epochs=50, device=cpu
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 1e-05
)
Loss function: MSELoss()
Training batches: 386
Validation batches: 82

Starting Epoch [1/50]

First batch details:
Scaled predictions (first 3):
[[0.19218408]
 [0.03507113]
 [0.07848455]]
Scaled targets (first 3):
[0.9589994  0.07161163 0.03919801]
Price predictions (first 3):
[936.65625254 175.98818454 386.17582848]
Price targets (first 3):
[4649.22075211  352.90032362  195.96860895]
Initial normalized MSE: 0.099950
Initial price-scale MSE: 2342871.34
Epoch [1/50] Summary:
  Normalized - Train MSE: 0.003353, RMSE: 0.057908
  Normalized - Val MSE: 0.000407, RMSE: 0.020172
  Price Scale - Train MSE: 78604.94, RMSE: $280.37
  Price Scale - Val MSE: 9538.31, RMSE: $97.66

Starting Epoch [2/50]
Epoch [2/50] Summary:
  Normalized - Train MSE: 0.001668, RMSE: 0.040844
  Normalized - Val MSE: 0.000529, RMSE: 0.022995
  Price Scale - Train MSE: 39104.43, RMSE: $197.75
  Price Scale - Val MSE: 12394.86, RMSE: $111.33

Starting Epoch [3/50]
Epoch [3/50] Summary:
  Normalized - Train MSE: 0.001371, RMSE: 0.037028
  Normalized - Val MSE: 0.000455, RMSE: 0.021327
  Price Scale - Train MSE: 32138.33, RMSE: $179.27
  Price Scale - Val MSE: 10661.68, RMSE: $103.26

Starting Epoch [4/50]
Epoch [4/50] Summary:
  Normalized - Train MSE: 0.001291, RMSE: 0.035931
  Normalized - Val MSE: 0.000259, RMSE: 0.016090
  Price Scale - Train MSE: 30263.17, RMSE: $173.96
  Price Scale - Val MSE: 6068.43, RMSE: $77.90

Starting Epoch [5/50]

Attention Pattern Sample (Epoch 5):
Average attention weights: [[0.02015501]
 [0.01938486]
 [0.02261002]
 [0.02081892]
 [0.0181096 ]]
Epoch [5/50] Summary:
  Normalized - Train MSE: 0.001263, RMSE: 0.035536
  Normalized - Val MSE: 0.000155, RMSE: 0.012446
  Price Scale - Train MSE: 29600.41, RMSE: $172.05
  Price Scale - Val MSE: 3630.77, RMSE: $60.26

Starting Epoch [6/50]
Epoch [6/50] Summary:
  Normalized - Train MSE: 0.001132, RMSE: 0.033650
  Normalized - Val MSE: 0.000059, RMSE: 0.007674
  Price Scale - Train MSE: 26542.41, RMSE: $162.92
  Price Scale - Val MSE: 1380.37, RMSE: $37.15

Starting Epoch [7/50]
Epoch [7/50] Summary:
  Normalized - Train MSE: 0.001149, RMSE: 0.033902
  Normalized - Val MSE: 0.000490, RMSE: 0.022130
  Price Scale - Train MSE: 26941.26, RMSE: $164.14
  Price Scale - Val MSE: 11479.71, RMSE: $107.14

Starting Epoch [8/50]
Epoch [8/50] Summary:
  Normalized - Train MSE: 0.001135, RMSE: 0.033697
  Normalized - Val MSE: 0.000092, RMSE: 0.009589
  Price Scale - Train MSE: 26615.80, RMSE: $163.14
  Price Scale - Val MSE: 2155.20, RMSE: $46.42

Starting Epoch [9/50]
Epoch [9/50] Summary:
  Normalized - Train MSE: 0.001146, RMSE: 0.033850
  Normalized - Val MSE: 0.000151, RMSE: 0.012293
  Price Scale - Train MSE: 26858.97, RMSE: $163.89
  Price Scale - Val MSE: 3542.46, RMSE: $59.52

Starting Epoch [10/50]

Attention Pattern Sample (Epoch 10):
Average attention weights: [[0.00022621]
 [0.00028741]
 [0.000331  ]
 [0.00049753]
 [0.00059029]]
Epoch [10/50] Summary:
  Normalized - Train MSE: 0.001391, RMSE: 0.037292
  Normalized - Val MSE: 0.000449, RMSE: 0.021184
  Price Scale - Train MSE: 32599.04, RMSE: $180.55
  Price Scale - Val MSE: 10519.22, RMSE: $102.56

Starting Epoch [11/50]
Epoch [11/50] Summary:
  Normalized - Train MSE: 0.001254, RMSE: 0.035413
  Normalized - Val MSE: 0.000442, RMSE: 0.021030
  Price Scale - Train MSE: 29396.51, RMSE: $171.45
  Price Scale - Val MSE: 10366.87, RMSE: $101.82

Starting Epoch [12/50]
Epoch [12/50] Summary:
  Normalized - Train MSE: 0.001066, RMSE: 0.032650
  Normalized - Val MSE: 0.000335, RMSE: 0.018291
  Price Scale - Train MSE: 24988.25, RMSE: $158.08
  Price Scale - Val MSE: 7842.60, RMSE: $88.56

Starting Epoch [13/50]
Epoch [13/50] Summary:
  Normalized - Train MSE: 0.001109, RMSE: 0.033297
  Normalized - Val MSE: 0.000172, RMSE: 0.013127
  Price Scale - Train MSE: 25988.45, RMSE: $161.21
  Price Scale - Val MSE: 4039.29, RMSE: $63.56

Starting Epoch [14/50]
Epoch [14/50] Summary:
  Normalized - Train MSE: 0.001065, RMSE: 0.032628
  Normalized - Val MSE: 0.000064, RMSE: 0.008024
  Price Scale - Train MSE: 24954.64, RMSE: $157.97
  Price Scale - Val MSE: 1509.23, RMSE: $38.85

Starting Epoch [15/50]

Attention Pattern Sample (Epoch 15):
Average attention weights: [[4.4045199e-09]
 [1.3272714e-09]
 [1.2372768e-09]
 [1.3697263e-09]
 [1.5081592e-09]]
Epoch [15/50] Summary:
  Normalized - Train MSE: 0.001016, RMSE: 0.031870
  Normalized - Val MSE: 0.000189, RMSE: 0.013753
  Price Scale - Train MSE: 23808.51, RMSE: $154.30
  Price Scale - Val MSE: 4433.89, RMSE: $66.59

Starting Epoch [16/50]
Epoch [16/50] Summary:
  Normalized - Train MSE: 0.001045, RMSE: 0.032323
  Normalized - Val MSE: 0.000198, RMSE: 0.014084
  Price Scale - Train MSE: 24490.62, RMSE: $156.49
  Price Scale - Val MSE: 4649.93, RMSE: $68.19

Starting Epoch [17/50]
Epoch [17/50] Summary:
  Normalized - Train MSE: 0.001030, RMSE: 0.032092
  Normalized - Val MSE: 0.000031, RMSE: 0.005543
  Price Scale - Train MSE: 24140.53, RMSE: $155.37
  Price Scale - Val MSE: 720.30, RMSE: $26.84

Starting Epoch [18/50]
Epoch [18/50] Summary:
  Normalized - Train MSE: 0.001025, RMSE: 0.032020
  Normalized - Val MSE: 0.000076, RMSE: 0.008735
  Price Scale - Train MSE: 24033.15, RMSE: $155.03
  Price Scale - Val MSE: 1788.67, RMSE: $42.29

Starting Epoch [19/50]
Epoch [19/50] Summary:
  Normalized - Train MSE: 0.000969, RMSE: 0.031133
  Normalized - Val MSE: 0.000293, RMSE: 0.017126
  Price Scale - Train MSE: 22720.31, RMSE: $150.73
  Price Scale - Val MSE: 6874.91, RMSE: $82.92

Starting Epoch [20/50]

Attention Pattern Sample (Epoch 20):
Average attention weights: [[1.9810196e-09]
 [1.2844453e-09]
 [1.1430780e-09]
 [9.8836428e-10]
 [1.1021368e-09]]
Epoch [20/50] Summary:
  Normalized - Train MSE: 0.000928, RMSE: 0.030466
  Normalized - Val MSE: 0.000036, RMSE: 0.005973
  Price Scale - Train MSE: 21757.54, RMSE: $147.50
  Price Scale - Val MSE: 836.28, RMSE: $28.92

Starting Epoch [21/50]
Epoch [21/50] Summary:
  Normalized - Train MSE: 0.000878, RMSE: 0.029631
  Normalized - Val MSE: 0.000090, RMSE: 0.009498
  Price Scale - Train MSE: 20581.01, RMSE: $143.46
  Price Scale - Val MSE: 2114.60, RMSE: $45.98

Starting Epoch [22/50]
Epoch [22/50] Summary:
  Normalized - Train MSE: 0.000875, RMSE: 0.029581
  Normalized - Val MSE: 0.000106, RMSE: 0.010300
  Price Scale - Train MSE: 20511.03, RMSE: $143.22
  Price Scale - Val MSE: 2486.70, RMSE: $49.87

Starting Epoch [23/50]
Epoch [23/50] Summary:
  Normalized - Train MSE: 0.000847, RMSE: 0.029107
  Normalized - Val MSE: 0.000178, RMSE: 0.013339
  Price Scale - Train MSE: 19859.02, RMSE: $140.92
  Price Scale - Val MSE: 4170.94, RMSE: $64.58

Starting Epoch [24/50]
Epoch [24/50] Summary:
  Normalized - Train MSE: 0.000812, RMSE: 0.028504
  Normalized - Val MSE: 0.000114, RMSE: 0.010657
  Price Scale - Train MSE: 19044.36, RMSE: $138.00
  Price Scale - Val MSE: 2662.37, RMSE: $51.60

Starting Epoch [25/50]

Attention Pattern Sample (Epoch 25):
Average attention weights: [[8.4188821e-07]
 [1.4244006e-07]
 [7.2441864e-08]
 [7.3868549e-08]
 [6.9128447e-08]]
Epoch [25/50] Summary:
  Normalized - Train MSE: 0.000786, RMSE: 0.028039
  Normalized - Val MSE: 0.000046, RMSE: 0.006783
  Price Scale - Train MSE: 18428.79, RMSE: $135.75
  Price Scale - Val MSE: 1078.54, RMSE: $32.84

Starting Epoch [26/50]
Epoch [26/50] Summary:
  Normalized - Train MSE: 0.000773, RMSE: 0.027810
  Normalized - Val MSE: 0.000046, RMSE: 0.006769
  Price Scale - Train MSE: 18129.20, RMSE: $134.64
  Price Scale - Val MSE: 1073.92, RMSE: $32.77

Starting Epoch [27/50]
Epoch [27/50] Summary:
  Normalized - Train MSE: 0.000718, RMSE: 0.026796
  Normalized - Val MSE: 0.000028, RMSE: 0.005280
  Price Scale - Train MSE: 16831.06, RMSE: $129.73
  Price Scale - Val MSE: 653.47, RMSE: $25.56

Starting Epoch [28/50]
Epoch [28/50] Summary:
  Normalized - Train MSE: 0.000705, RMSE: 0.026550
  Normalized - Val MSE: 0.000056, RMSE: 0.007493
  Price Scale - Train MSE: 16523.73, RMSE: $128.54
  Price Scale - Val MSE: 1316.03, RMSE: $36.28

Starting Epoch [29/50]
Epoch [29/50] Summary:
  Normalized - Train MSE: 0.000699, RMSE: 0.026444
  Normalized - Val MSE: 0.000058, RMSE: 0.007605
  Price Scale - Train MSE: 16391.62, RMSE: $128.03
  Price Scale - Val MSE: 1355.83, RMSE: $36.82

Starting Epoch [30/50]

Attention Pattern Sample (Epoch 30):
Average attention weights: [[1.3384293e-05]
 [8.9327132e-06]
 [4.3226119e-06]
 [6.1792263e-05]
 [3.9730192e-05]]
Epoch [30/50] Summary:
  Normalized - Train MSE: 0.000633, RMSE: 0.025163
  Normalized - Val MSE: 0.000113, RMSE: 0.010618
  Price Scale - Train MSE: 14842.11, RMSE: $121.83
  Price Scale - Val MSE: 2642.82, RMSE: $51.41

Starting Epoch [31/50]
Epoch [31/50] Summary:
  Normalized - Train MSE: 0.000705, RMSE: 0.026552
  Normalized - Val MSE: 0.000387, RMSE: 0.019667
  Price Scale - Train MSE: 16525.85, RMSE: $128.55
  Price Scale - Val MSE: 9066.32, RMSE: $95.22

Starting Epoch [32/50]
Epoch [32/50] Summary:
  Normalized - Train MSE: 0.000682, RMSE: 0.026108
  Normalized - Val MSE: 0.000049, RMSE: 0.006975
  Price Scale - Train MSE: 15977.75, RMSE: $126.40
  Price Scale - Val MSE: 1140.51, RMSE: $33.77

Starting Epoch [33/50]
Epoch [33/50] Summary:
  Normalized - Train MSE: 0.000680, RMSE: 0.026069
  Normalized - Val MSE: 0.000057, RMSE: 0.007524
  Price Scale - Train MSE: 15929.48, RMSE: $126.21
  Price Scale - Val MSE: 1327.05, RMSE: $36.43

Starting Epoch [34/50]
Epoch [34/50] Summary:
  Normalized - Train MSE: 0.000696, RMSE: 0.026377
  Normalized - Val MSE: 0.000069, RMSE: 0.008315
  Price Scale - Train MSE: 16308.77, RMSE: $127.71
  Price Scale - Val MSE: 1620.62, RMSE: $40.26

Starting Epoch [35/50]

Attention Pattern Sample (Epoch 35):
Average attention weights: [[5.5974491e-05]
 [2.2954626e-05]
 [2.7099657e-05]
 [2.2517024e-05]
 [1.8961508e-05]]
Epoch [35/50] Summary:
  Normalized - Train MSE: 0.000629, RMSE: 0.025088
  Normalized - Val MSE: 0.000046, RMSE: 0.006785
  Price Scale - Train MSE: 14753.67, RMSE: $121.46
  Price Scale - Val MSE: 1079.03, RMSE: $32.85

Starting Epoch [36/50]
Epoch [36/50] Summary:
  Normalized - Train MSE: 0.000628, RMSE: 0.025056
  Normalized - Val MSE: 0.000042, RMSE: 0.006448
  Price Scale - Train MSE: 14716.45, RMSE: $121.31
  Price Scale - Val MSE: 974.61, RMSE: $31.22

Starting Epoch [37/50]
Epoch [37/50] Summary:
  Normalized - Train MSE: 0.000587, RMSE: 0.024228
  Normalized - Val MSE: 0.000042, RMSE: 0.006481
  Price Scale - Train MSE: 13759.80, RMSE: $117.30
  Price Scale - Val MSE: 984.67, RMSE: $31.38

Starting Epoch [38/50]
Epoch [38/50] Summary:
  Normalized - Train MSE: 0.000649, RMSE: 0.025475
  Normalized - Val MSE: 0.000088, RMSE: 0.009370
  Price Scale - Train MSE: 15212.45, RMSE: $123.34
  Price Scale - Val MSE: 2058.00, RMSE: $45.37

Starting Epoch [39/50]
Epoch [39/50] Summary:
  Normalized - Train MSE: 0.000683, RMSE: 0.026127
  Normalized - Val MSE: 0.000159, RMSE: 0.012607
  Price Scale - Train MSE: 16001.01, RMSE: $126.50
  Price Scale - Val MSE: 3725.40, RMSE: $61.04

Starting Epoch [40/50]

Attention Pattern Sample (Epoch 40):
Average attention weights: [[3.9269514e-07]
 [2.0319941e-07]
 [7.5455597e-07]
 [6.2560065e-07]
 [9.8006490e-07]]
Epoch [40/50] Summary:
  Normalized - Train MSE: 0.000597, RMSE: 0.024440
  Normalized - Val MSE: 0.000090, RMSE: 0.009477
  Price Scale - Train MSE: 14001.68, RMSE: $118.33
  Price Scale - Val MSE: 2105.46, RMSE: $45.89

Starting Epoch [41/50]
Epoch [41/50] Summary:
  Normalized - Train MSE: 0.000626, RMSE: 0.025014
  Normalized - Val MSE: 0.000217, RMSE: 0.014738
  Price Scale - Train MSE: 14666.58, RMSE: $121.11
  Price Scale - Val MSE: 5091.79, RMSE: $71.36

Starting Epoch [42/50]
Epoch [42/50] Summary:
  Normalized - Train MSE: 0.000659, RMSE: 0.025671
  Normalized - Val MSE: 0.000030, RMSE: 0.005521
  Price Scale - Train MSE: 15447.19, RMSE: $124.29
  Price Scale - Val MSE: 714.59, RMSE: $26.73

Starting Epoch [43/50]
Epoch [43/50] Summary:
  Normalized - Train MSE: 0.000627, RMSE: 0.025033
  Normalized - Val MSE: 0.000050, RMSE: 0.007095
  Price Scale - Train MSE: 14688.65, RMSE: $121.20
  Price Scale - Val MSE: 1179.99, RMSE: $34.35

Starting Epoch [44/50]
Epoch [44/50] Summary:
  Normalized - Train MSE: 0.000606, RMSE: 0.024624
  Normalized - Val MSE: 0.000118, RMSE: 0.010860
  Price Scale - Train MSE: 14212.75, RMSE: $119.22
  Price Scale - Val MSE: 2764.71, RMSE: $52.58

Starting Epoch [45/50]

Attention Pattern Sample (Epoch 45):
Average attention weights: [[1.4256984e-06]
 [1.0846439e-06]
 [1.3065063e-06]
 [9.2381498e-07]
 [1.4459597e-06]]
Epoch [45/50] Summary:
  Normalized - Train MSE: 0.000590, RMSE: 0.024293
  Normalized - Val MSE: 0.000033, RMSE: 0.005778
  Price Scale - Train MSE: 13833.25, RMSE: $117.61
  Price Scale - Val MSE: 782.53, RMSE: $27.97

Starting Epoch [46/50]
Epoch [46/50] Summary:
  Normalized - Train MSE: 0.000597, RMSE: 0.024427
  Normalized - Val MSE: 0.000043, RMSE: 0.006579
  Price Scale - Train MSE: 13986.80, RMSE: $118.27
  Price Scale - Val MSE: 1014.49, RMSE: $31.85

Starting Epoch [47/50]
Epoch [47/50] Summary:
  Normalized - Train MSE: 0.000586, RMSE: 0.024203
  Normalized - Val MSE: 0.000030, RMSE: 0.005454
  Price Scale - Train MSE: 13731.00, RMSE: $117.18
  Price Scale - Val MSE: 697.33, RMSE: $26.41

Starting Epoch [48/50]
Epoch [48/50] Summary:
  Normalized - Train MSE: 0.000600, RMSE: 0.024485
  Normalized - Val MSE: 0.000140, RMSE: 0.011815
  Price Scale - Train MSE: 14053.33, RMSE: $118.55
  Price Scale - Val MSE: 3272.10, RMSE: $57.20

Starting Epoch [49/50]
Epoch [49/50] Summary:
  Normalized - Train MSE: 0.000596, RMSE: 0.024416
  Normalized - Val MSE: 0.000038, RMSE: 0.006135
  Price Scale - Train MSE: 13973.74, RMSE: $118.21
  Price Scale - Val MSE: 882.18, RMSE: $29.70

Starting Epoch [50/50]

Attention Pattern Sample (Epoch 50):
Average attention weights: [[0.00039315]
 [0.00021334]
 [0.00025055]
 [0.00031698]
 [0.00028067]]
Epoch [50/50] Summary:
  Normalized - Train MSE: 0.000632, RMSE: 0.025134
  Normalized - Val MSE: 0.000174, RMSE: 0.013196
  Price Scale - Train MSE: 14807.41, RMSE: $121.69
  Price Scale - Val MSE: 4081.83, RMSE: $63.89
Training completed in 1464.77 seconds
Saving model and results...
Starting evaluation process...
Generating predictions...
Creating visualizations...
Training history plot saved
Prediction analysis plots saved
Metrics and sample predictions tables saved
Error distribution and time series plots saved
Creating attention visualizations...
Attention visualization plots saved
Evaluation metrics (for test set):
  Mean Squared Error ($): 14520.76
  Root Mean Squared Error ($): 120.50
  Mean Absolute Error ($): 108.25
  Mean Absolute Percentage Error (%): 4.02
  Weighted MAPE (%): 4.09
  Directional Accuracy (%): 47.81
  Maximum Absolute Error ($): 607.84
  Mean Percentage Error (%): 3.98
  R² Score: 0.97
