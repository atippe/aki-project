=== Starting new training run ===
Crypto Currency: eth

Model Parameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.2
  num_epochs: 50
  batch_size: 32
  learning_rate: 0.001
  device: cpu
  weight_decay: 1e-05
  betas: (0.9, 0.999)
  eps: 1e-08
  criterion: MSE
Loading pre-processed data...

=== Dataset Configuration ===
Sequence length: 60
Feature count: 5
Feature indices: {'Volume': 0, 'Open': 1, 'High': 2, 'Low': 3, 'Close': 4}
Close price index: 4

=== Data Shapes ===
Training set shape: torch.Size([2007, 60, 5])
Validation set shape: torch.Size([383, 60, 5])
Test set shape: torch.Size([384, 60, 5])

=== Date Range ===
Start date: 2016-09-29
End date: 2024-10-30

=== Feature Alignment Verification ===
Feature alignment test - Close position: 4
Inverse transform test shape: (1, 5)
Model input size: 5
Starting training process...
Starting training process
Model architecture:
AdvancedPricePredictionModel(
  (lstm): EnhancedLSTM(
    (lstm_cells): ModuleList(
      (0): CustomLSTMCell(
        (dropout): Dropout(p=0.2, inplace=False)
        (layer_norm_1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (layer_norm_2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (gates): Linear(in_features=133, out_features=512, bias=True)
        (residual_proj): Linear(in_features=5, out_features=128, bias=True)
      )
      (1): CustomLSTMCell(
        (dropout): Dropout(p=0.2, inplace=False)
        (layer_norm_1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (layer_norm_2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (gates): Linear(in_features=256, out_features=512, bias=True)
      )
    )
    (attention): AttentionLayer(
      (attention): Sequential(
        (0): Linear(in_features=128, out_features=128, bias=True)
        (1): Tanh()
        (2): Linear(in_features=128, out_features=1, bias=True)
      )
    )
    (skip_connections): ModuleList(
      (0-1): 2 x Linear(in_features=5, out_features=128, bias=True)
    )
  )
  (prediction_head): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)
Training parameters: epochs=50, device=cpu
Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 1e-05
)
Loss function: MSELoss()
Training batches: 63
Validation batches: 12

Starting Epoch [1/50]

First batch details:
Scaled predictions (first 3):
[[-0.39203218]
 [ 0.11171752]
 [ 0.01111735]]
Scaled targets (first 3):
[ 1.5173781 -0.6193677 -0.5464123]
Price predictions (first 3):
[194.64964179 420.18009069 360.38413305]
Price targets (first 3):
[3576.98079344  137.42216854  153.67875528]
Initial normalized MSE: 0.952891
Initial price-scale MSE: 1475324.01
Epoch [1/50] Summary:
  Normalized - Train MSE: 0.077273, RMSE: 0.277981
  Normalized - Val MSE: 0.007232, RMSE: 0.085039
  Price Scale - Train MSE: 323828.01, RMSE: $569.06
  Price Scale - Val MSE: 41464.29, RMSE: $203.63

Starting Epoch [2/50]
Epoch [2/50] Summary:
  Normalized - Train MSE: 0.027175, RMSE: 0.164849
  Normalized - Val MSE: 0.007513, RMSE: 0.086675
  Price Scale - Train MSE: 188032.97, RMSE: $433.63
  Price Scale - Val MSE: 44462.92, RMSE: $210.86

Starting Epoch [3/50]
Epoch [3/50] Summary:
  Normalized - Train MSE: 0.025704, RMSE: 0.160324
  Normalized - Val MSE: 0.006151, RMSE: 0.078428
  Price Scale - Train MSE: 195152.58, RMSE: $441.76
  Price Scale - Val MSE: 33154.67, RMSE: $182.08

Starting Epoch [4/50]
Epoch [4/50] Summary:
  Normalized - Train MSE: 0.019272, RMSE: 0.138825
  Normalized - Val MSE: 0.009035, RMSE: 0.095054
  Price Scale - Train MSE: 163749.26, RMSE: $404.66
  Price Scale - Val MSE: 49902.67, RMSE: $223.39

Starting Epoch [5/50]

Attention Pattern Sample (Epoch 5):
Average attention weights: [[2.0551147e-04]
 [8.1002247e-05]
 [8.0409001e-05]
 [9.0678775e-05]
 [1.9368778e-04]]
Epoch [5/50] Summary:
  Normalized - Train MSE: 0.017154, RMSE: 0.130973
  Normalized - Val MSE: 0.003283, RMSE: 0.057302
  Price Scale - Train MSE: 156537.93, RMSE: $395.65
  Price Scale - Val MSE: 18817.28, RMSE: $137.18

Starting Epoch [6/50]
Epoch [6/50] Summary:
  Normalized - Train MSE: 0.021993, RMSE: 0.148301
  Normalized - Val MSE: 0.010858, RMSE: 0.104203
  Price Scale - Train MSE: 164575.20, RMSE: $405.68
  Price Scale - Val MSE: 71042.45, RMSE: $266.54

Starting Epoch [7/50]
Epoch [7/50] Summary:
  Normalized - Train MSE: 0.017318, RMSE: 0.131598
  Normalized - Val MSE: 0.015157, RMSE: 0.123114
  Price Scale - Train MSE: 145943.68, RMSE: $382.03
  Price Scale - Val MSE: 86931.88, RMSE: $294.84

Starting Epoch [8/50]
Epoch [8/50] Summary:
  Normalized - Train MSE: 0.015718, RMSE: 0.125373
  Normalized - Val MSE: 0.000814, RMSE: 0.028522
  Price Scale - Train MSE: 151344.45, RMSE: $389.03
  Price Scale - Val MSE: 4748.49, RMSE: $68.91

Starting Epoch [9/50]
Epoch [9/50] Summary:
  Normalized - Train MSE: 0.014973, RMSE: 0.122363
  Normalized - Val MSE: 0.001238, RMSE: 0.035192
  Price Scale - Train MSE: 151893.63, RMSE: $389.74
  Price Scale - Val MSE: 7418.19, RMSE: $86.13

Starting Epoch [10/50]

Attention Pattern Sample (Epoch 10):
Average attention weights: [[4.8331476e-05]
 [5.2736465e-05]
 [4.3197833e-05]
 [5.2607546e-05]
 [8.0107449e-05]]
Epoch [10/50] Summary:
  Normalized - Train MSE: 0.016436, RMSE: 0.128203
  Normalized - Val MSE: 0.002944, RMSE: 0.054255
  Price Scale - Train MSE: 158844.50, RMSE: $398.55
  Price Scale - Val MSE: 17672.35, RMSE: $132.94

Starting Epoch [11/50]
Epoch [11/50] Summary:
  Normalized - Train MSE: 0.014175, RMSE: 0.119060
  Normalized - Val MSE: 0.000733, RMSE: 0.027078
  Price Scale - Train MSE: 139858.29, RMSE: $373.98
  Price Scale - Val MSE: 4385.82, RMSE: $66.23

Starting Epoch [12/50]
Epoch [12/50] Summary:
  Normalized - Train MSE: 0.013112, RMSE: 0.114510
  Normalized - Val MSE: 0.005847, RMSE: 0.076463
  Price Scale - Train MSE: 109037.34, RMSE: $330.21
  Price Scale - Val MSE: 33549.18, RMSE: $183.16

Starting Epoch [13/50]
Epoch [13/50] Summary:
  Normalized - Train MSE: 0.014571, RMSE: 0.120712
  Normalized - Val MSE: 0.000692, RMSE: 0.026308
  Price Scale - Train MSE: 148204.65, RMSE: $384.97
  Price Scale - Val MSE: 3903.30, RMSE: $62.48

Starting Epoch [14/50]
Epoch [14/50] Summary:
  Normalized - Train MSE: 0.012606, RMSE: 0.112277
  Normalized - Val MSE: 0.010086, RMSE: 0.100428
  Price Scale - Train MSE: 117732.77, RMSE: $343.12
  Price Scale - Val MSE: 55779.98, RMSE: $236.18

Starting Epoch [15/50]

Attention Pattern Sample (Epoch 15):
Average attention weights: [[3.1759602e-05]
 [4.7549020e-06]
 [4.0330115e-06]
 [1.7932689e-06]
 [7.4298367e-07]]
Epoch [15/50] Summary:
  Normalized - Train MSE: 0.012483, RMSE: 0.111728
  Normalized - Val MSE: 0.001013, RMSE: 0.031831
  Price Scale - Train MSE: 111149.43, RMSE: $333.39
  Price Scale - Val MSE: 5716.88, RMSE: $75.61

Starting Epoch [16/50]
Epoch [16/50] Summary:
  Normalized - Train MSE: 0.012661, RMSE: 0.112522
  Normalized - Val MSE: 0.002398, RMSE: 0.048966
  Price Scale - Train MSE: 135101.68, RMSE: $367.56
  Price Scale - Val MSE: 14647.31, RMSE: $121.03

Starting Epoch [17/50]
Epoch [17/50] Summary:
  Normalized - Train MSE: 0.012067, RMSE: 0.109850
  Normalized - Val MSE: 0.000569, RMSE: 0.023860
  Price Scale - Train MSE: 101571.81, RMSE: $318.70
  Price Scale - Val MSE: 3210.21, RMSE: $56.66

Starting Epoch [18/50]
Epoch [18/50] Summary:
  Normalized - Train MSE: 0.012069, RMSE: 0.109857
  Normalized - Val MSE: 0.002673, RMSE: 0.051701
  Price Scale - Train MSE: 106735.84, RMSE: $326.70
  Price Scale - Val MSE: 17307.90, RMSE: $131.56

Starting Epoch [19/50]
Epoch [19/50] Summary:
  Normalized - Train MSE: 0.013556, RMSE: 0.116432
  Normalized - Val MSE: 0.000881, RMSE: 0.029674
  Price Scale - Train MSE: 124625.41, RMSE: $353.02
  Price Scale - Val MSE: 4663.98, RMSE: $68.29

Starting Epoch [20/50]

Attention Pattern Sample (Epoch 20):
Average attention weights: [[2.2648721e-06]
 [4.6694501e-07]
 [6.9283124e-07]
 [7.2591217e-07]
 [1.3776756e-06]]
Epoch [20/50] Summary:
  Normalized - Train MSE: 0.011415, RMSE: 0.106842
  Normalized - Val MSE: 0.000627, RMSE: 0.025045
  Price Scale - Train MSE: 116277.47, RMSE: $340.99
  Price Scale - Val MSE: 3586.86, RMSE: $59.89

Starting Epoch [21/50]
Epoch [21/50] Summary:
  Normalized - Train MSE: 0.012840, RMSE: 0.113314
  Normalized - Val MSE: 0.001112, RMSE: 0.033350
  Price Scale - Train MSE: 136495.98, RMSE: $369.45
  Price Scale - Val MSE: 6677.82, RMSE: $81.72

Starting Epoch [22/50]
Epoch [22/50] Summary:
  Normalized - Train MSE: 0.011551, RMSE: 0.107476
  Normalized - Val MSE: 0.002142, RMSE: 0.046284
  Price Scale - Train MSE: 110598.80, RMSE: $332.56
  Price Scale - Val MSE: 12856.93, RMSE: $113.39

Starting Epoch [23/50]
Epoch [23/50] Summary:
  Normalized - Train MSE: 0.012086, RMSE: 0.109937
  Normalized - Val MSE: 0.002088, RMSE: 0.045696
  Price Scale - Train MSE: 100836.43, RMSE: $317.55
  Price Scale - Val MSE: 12956.43, RMSE: $113.83

Starting Epoch [24/50]
Epoch [24/50] Summary:
  Normalized - Train MSE: 0.012665, RMSE: 0.112538
  Normalized - Val MSE: 0.003959, RMSE: 0.062921
  Price Scale - Train MSE: 99451.13, RMSE: $315.36
  Price Scale - Val MSE: 25471.89, RMSE: $159.60

Starting Epoch [25/50]

Attention Pattern Sample (Epoch 25):
Average attention weights: [[6.4303561e-07]
 [2.4449337e-06]
 [2.0140476e-06]
 [3.3138308e-06]
 [1.7320559e-06]]
Epoch [25/50] Summary:
  Normalized - Train MSE: 0.011852, RMSE: 0.108867
  Normalized - Val MSE: 0.000777, RMSE: 0.027881
  Price Scale - Train MSE: 104468.64, RMSE: $323.22
  Price Scale - Val MSE: 4378.45, RMSE: $66.17

Starting Epoch [26/50]
Epoch [26/50] Summary:
  Normalized - Train MSE: 0.012498, RMSE: 0.111794
  Normalized - Val MSE: 0.001492, RMSE: 0.038628
  Price Scale - Train MSE: 100627.51, RMSE: $317.22
  Price Scale - Val MSE: 8966.15, RMSE: $94.69

Starting Epoch [27/50]
Epoch [27/50] Summary:
  Normalized - Train MSE: 0.010678, RMSE: 0.103333
  Normalized - Val MSE: 0.001501, RMSE: 0.038744
  Price Scale - Train MSE: 95713.76, RMSE: $309.38
  Price Scale - Val MSE: 9235.61, RMSE: $96.10

Starting Epoch [28/50]
Epoch [28/50] Summary:
  Normalized - Train MSE: 0.011498, RMSE: 0.107231
  Normalized - Val MSE: 0.000724, RMSE: 0.026914
  Price Scale - Train MSE: 128970.60, RMSE: $359.12
  Price Scale - Val MSE: 3930.21, RMSE: $62.69

Starting Epoch [29/50]
Epoch [29/50] Summary:
  Normalized - Train MSE: 0.010864, RMSE: 0.104228
  Normalized - Val MSE: 0.004984, RMSE: 0.070599
  Price Scale - Train MSE: 99940.92, RMSE: $316.13
  Price Scale - Val MSE: 33511.89, RMSE: $183.06

Starting Epoch [30/50]

Attention Pattern Sample (Epoch 30):
Average attention weights: [[1.7770354e-06]
 [9.4848122e-07]
 [4.9129603e-06]
 [2.9257191e-05]
 [5.6885642e-06]]
Epoch [30/50] Summary:
  Normalized - Train MSE: 0.012198, RMSE: 0.110445
  Normalized - Val MSE: 0.001057, RMSE: 0.032504
  Price Scale - Train MSE: 135853.47, RMSE: $368.58
  Price Scale - Val MSE: 6534.71, RMSE: $80.84

Starting Epoch [31/50]
Epoch [31/50] Summary:
  Normalized - Train MSE: 0.010239, RMSE: 0.101190
  Normalized - Val MSE: 0.000535, RMSE: 0.023129
  Price Scale - Train MSE: 96013.40, RMSE: $309.86
  Price Scale - Val MSE: 3033.08, RMSE: $55.07

Starting Epoch [32/50]
Epoch [32/50] Summary:
  Normalized - Train MSE: 0.012151, RMSE: 0.110230
  Normalized - Val MSE: 0.003071, RMSE: 0.055416
  Price Scale - Train MSE: 124537.35, RMSE: $352.90
  Price Scale - Val MSE: 18665.28, RMSE: $136.62

Starting Epoch [33/50]
Epoch [33/50] Summary:
  Normalized - Train MSE: 0.010078, RMSE: 0.100387
  Normalized - Val MSE: 0.002604, RMSE: 0.051032
  Price Scale - Train MSE: 114152.83, RMSE: $337.87
  Price Scale - Val MSE: 15956.93, RMSE: $126.32

Starting Epoch [34/50]
Epoch [34/50] Summary:
  Normalized - Train MSE: 0.011476, RMSE: 0.107127
  Normalized - Val MSE: 0.000583, RMSE: 0.024152
  Price Scale - Train MSE: 117404.70, RMSE: $342.64
  Price Scale - Val MSE: 3281.72, RMSE: $57.29

Starting Epoch [35/50]

Attention Pattern Sample (Epoch 35):
Average attention weights: [[1.1711884e-08]
 [4.8610338e-09]
 [4.1590744e-09]
 [4.0212225e-09]
 [5.8207910e-09]]
Epoch [35/50] Summary:
  Normalized - Train MSE: 0.013176, RMSE: 0.114785
  Normalized - Val MSE: 0.001686, RMSE: 0.041062
  Price Scale - Train MSE: 124943.04, RMSE: $353.47
  Price Scale - Val MSE: 10179.11, RMSE: $100.89

Starting Epoch [36/50]
Epoch [36/50] Summary:
  Normalized - Train MSE: 0.011030, RMSE: 0.105025
  Normalized - Val MSE: 0.000531, RMSE: 0.023037
  Price Scale - Train MSE: 105362.40, RMSE: $324.60
  Price Scale - Val MSE: 3010.07, RMSE: $54.86

Starting Epoch [37/50]
Epoch [37/50] Summary:
  Normalized - Train MSE: 0.012378, RMSE: 0.111256
  Normalized - Val MSE: 0.000726, RMSE: 0.026947
  Price Scale - Train MSE: 106861.88, RMSE: $326.90
  Price Scale - Val MSE: 4436.17, RMSE: $66.60

Starting Epoch [38/50]
Epoch [38/50] Summary:
  Normalized - Train MSE: 0.013164, RMSE: 0.114732
  Normalized - Val MSE: 0.000970, RMSE: 0.031142
  Price Scale - Train MSE: 115257.46, RMSE: $339.50
  Price Scale - Val MSE: 5241.06, RMSE: $72.40

Starting Epoch [39/50]
Epoch [39/50] Summary:
  Normalized - Train MSE: 0.011914, RMSE: 0.109149
  Normalized - Val MSE: 0.002589, RMSE: 0.050887
  Price Scale - Train MSE: 117732.06, RMSE: $343.12
  Price Scale - Val MSE: 16090.80, RMSE: $126.85

Starting Epoch [40/50]

Attention Pattern Sample (Epoch 40):
Average attention weights: [[5.7838241e-09]
 [3.3289556e-08]
 [3.7818509e-08]
 [2.1592972e-07]
 [7.6243758e-08]]
Epoch [40/50] Summary:
  Normalized - Train MSE: 0.014555, RMSE: 0.120645
  Normalized - Val MSE: 0.000591, RMSE: 0.024311
  Price Scale - Train MSE: 123135.45, RMSE: $350.91
  Price Scale - Val MSE: 3286.42, RMSE: $57.33

Starting Epoch [41/50]
Epoch [41/50] Summary:
  Normalized - Train MSE: 0.012420, RMSE: 0.111443
  Normalized - Val MSE: 0.011385, RMSE: 0.106699
  Price Scale - Train MSE: 113135.52, RMSE: $336.36
  Price Scale - Val MSE: 82775.45, RMSE: $287.71

Starting Epoch [42/50]
Epoch [42/50] Summary:
  Normalized - Train MSE: 0.010436, RMSE: 0.102157
  Normalized - Val MSE: 0.000601, RMSE: 0.024513
  Price Scale - Train MSE: 110204.84, RMSE: $331.97
  Price Scale - Val MSE: 3334.65, RMSE: $57.75

Starting Epoch [43/50]
Epoch [43/50] Summary:
  Normalized - Train MSE: 0.011182, RMSE: 0.105744
  Normalized - Val MSE: 0.001163, RMSE: 0.034106
  Price Scale - Train MSE: 95243.19, RMSE: $308.61
  Price Scale - Val MSE: 6906.01, RMSE: $83.10

Starting Epoch [44/50]
Epoch [44/50] Summary:
  Normalized - Train MSE: 0.011948, RMSE: 0.109305
  Normalized - Val MSE: 0.001175, RMSE: 0.034283
  Price Scale - Train MSE: 132862.20, RMSE: $364.50
  Price Scale - Val MSE: 7054.60, RMSE: $83.99

Starting Epoch [45/50]

Attention Pattern Sample (Epoch 45):
Average attention weights: [[5.1341613e-13]
 [3.7809366e-13]
 [7.5301034e-13]
 [9.7006702e-13]
 [1.0835067e-12]]
Epoch [45/50] Summary:
  Normalized - Train MSE: 0.011028, RMSE: 0.105014
  Normalized - Val MSE: 0.001805, RMSE: 0.042487
  Price Scale - Train MSE: 104067.89, RMSE: $322.60
  Price Scale - Val MSE: 10948.36, RMSE: $104.63

Starting Epoch [46/50]
Epoch [46/50] Summary:
  Normalized - Train MSE: 0.010536, RMSE: 0.102647
  Normalized - Val MSE: 0.000587, RMSE: 0.024225
  Price Scale - Train MSE: 93577.82, RMSE: $305.90
  Price Scale - Val MSE: 3449.58, RMSE: $58.73

Starting Epoch [47/50]
Epoch [47/50] Summary:
  Normalized - Train MSE: 0.010546, RMSE: 0.102693
  Normalized - Val MSE: 0.001066, RMSE: 0.032655
  Price Scale - Train MSE: 102462.70, RMSE: $320.10
  Price Scale - Val MSE: 6613.59, RMSE: $81.32

Starting Epoch [48/50]
Epoch [48/50] Summary:
  Normalized - Train MSE: 0.010184, RMSE: 0.100914
  Normalized - Val MSE: 0.000841, RMSE: 0.029005
  Price Scale - Train MSE: 101163.76, RMSE: $318.06
  Price Scale - Val MSE: 4895.97, RMSE: $69.97

Starting Epoch [49/50]
Epoch [49/50] Summary:
  Normalized - Train MSE: 0.010831, RMSE: 0.104070
  Normalized - Val MSE: 0.000606, RMSE: 0.024624
  Price Scale - Train MSE: 104688.08, RMSE: $323.56
  Price Scale - Val MSE: 3453.34, RMSE: $58.77

Starting Epoch [50/50]

Attention Pattern Sample (Epoch 50):
Average attention weights: [[1.7415533e-11]
 [4.6277869e-12]
 [1.3283700e-12]
 [6.5441554e-13]
 [8.0657242e-13]]
Epoch [50/50] Summary:
  Normalized - Train MSE: 0.010768, RMSE: 0.103771
  Normalized - Val MSE: 0.000559, RMSE: 0.023653
  Price Scale - Train MSE: 116619.39, RMSE: $341.50
  Price Scale - Val MSE: 3088.65, RMSE: $55.58
Training completed in 498.66 seconds
Saving model and results...
Starting evaluation process...
Generating predictions...
Creating visualizations...
Training history plot saved
Prediction analysis plots saved
Metrics and sample predictions tables saved
Error distribution and time series plots saved
Creating attention visualizations...
Attention visualization plots saved
Evaluation metrics (for test set):
  Mean Squared Error ($): 23420.66
  Root Mean Squared Error ($): 153.04
  Mean Absolute Error ($): 119.35
  Mean Absolute Percentage Error (%): 4.01
  Weighted MAPE (%): 4.29
  Directional Accuracy (%): 47.26
  Maximum Absolute Error ($): 734.41
  Mean Percentage Error (%): 3.33
  R² Score: 0.94
